<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:TexTool"
    xmlns:av="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="av" x:Class="TexTool.MainWindow"
    Title="MainWindow" Height="528" Width="942">
    <Window.Resources>
        <local:SizeConverter x:Key="SizeConverter" />
        <local:ResolutionConverter x:Key="ResolutionConverter" />
    </Window.Resources>
    <DockPanel>
        <!-- Статусная строка -->
        <StatusBar DockPanel.Dock="Bottom">
            <StatusBarItem>
                <TextBlock x:Name="ConnectionStatusTextBlock" Text="Disconnected" VerticalAlignment="Center" Width="320"/>
            </StatusBarItem>
        </StatusBar>

        <!-- Прогресс -->
        <Grid DockPanel.Dock="Bottom" HorizontalAlignment="Stretch">
            <ProgressBar x:Name="ProgressBar" Height="16" HorizontalAlignment="Stretch" VerticalAlignment="Center"/>
            <TextBlock x:Name="ProgressTextBlock" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="Black" FontWeight="Bold"/>
        </Grid>

        <!-- Панель управления внизу -->
        <StackPanel DockPanel.Dock="Bottom" Margin="2,4,2,4" Orientation="Horizontal" Width="922" Height="90" VerticalAlignment="Top">
            <GroupBox Header="Playcanvas Project Connect" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" VerticalAlignment="Top" Margin="2,2,2,2" Width="789">
                <StackPanel Orientation="Horizontal" Margin="0,0,-128,0" Height="58">
                    <Button Content="Connect" Margin="4,2,4,2" VerticalAlignment="Center" Width="74" Click="Connect" />
                    <!-- <Button Content="Get Projects" Margin="4,2,4,2" VerticalAlignment="Center" Width="74" Click="Connect" />-->
                    <ComboBox x:Name="ProjectsComboBox" Height="20" SelectionChanged="ProjectsComboBox_SelectionChanged" AutomationProperties.Name="Projects" Margin="4,0,4,0" MinWidth="120" Width="115" />
                    <ComboBox x:Name="BranchesComboBox" Height="20" AutomationProperties.Name="Branches" Margin="4,0,4,0" SelectionChanged="BranchesComboBox_SelectionChanged" MinWidth="85"/>

                    <Button Content="Get Textures" Margin="4,2,4,2" VerticalAlignment="Center" Width="74" Click="GetListTextures"/>
                    <Button Content="Select folder" Margin="4,2,4,2" VerticalAlignment="Center" Width="74" Click="SelectFolder" AutomationProperties.Name="SelectFolder" Height="NaN" RenderTransformOrigin="1.514,0.574"/>
                    <Button Content="Download" Margin="4,2,4,2" VerticalAlignment="Center" Width="74" Click="Download" ScrollViewer.VerticalScrollBarVisibility="Disabled"
                            IsEnabled="{Binding IsDownloadButtonEnabled}" AutomationProperties.Name="Download"/>
                    <TextBox Text="{Binding SelectedFolderPath, FallbackValue=Textures Download Folder, UpdateSourceTrigger=PropertyChanged}" VerticalContentAlignment="Center" IsReadOnly="True" Height="24" Width="138" FontSize="10"/>

                </StackPanel>
            </GroupBox>
            <StackPanel Width="121" Orientation="Horizontal" FlowDirection="RightToLeft" VerticalAlignment="Center">
                <Button Content="Settings" Margin="10,0,10,0" VerticalAlignment="Center" HorizontalAlignment="Center" Background="#FFFBD8C3" Click="Setting"/>
            </StackPanel>
        </StackPanel>

        <!-- Основной контент -->
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="1*" />
                <ColumnDefinition Width="1*" />
            </Grid.ColumnDefinitions>

            <DataGrid x:Name="TexturesDataGrid" 
                      BorderBrush="#FF343C44" 
                      FontSize="9" FontFamily="Segoe UI Symbol"
                      AutoGenerateColumns="False"
                      SelectionChanged="TexturesDataGrid_SelectionChanged"
                      IsReadOnly="True"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      CanUserSortColumns="True"
                      Background="#FFD6D6D6" Grid.ColumnSpan="2">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Texture Name" Binding="{Binding Name}" Width="*" MinWidth="80"/>
                    <DataGridTextColumn Header="Size" Binding="{Binding Size, Converter={StaticResource SizeConverter}}" Width="*" MinWidth="35"/>
                    <DataGridTextColumn Header="Url" Binding="{Binding Url}" Width="*" MinWidth="100"/>
                    <DataGridTextColumn Header="Resolution" Binding="{Binding Resolution, Converter={StaticResource ResolutionConverter}}" Width="*" MinWidth="75" SortMemberPath="ResolutionArea"/>
                    <DataGridTextColumn Header="Resize Resolution" Binding="{Binding ResizeResolution, Converter={StaticResource ResolutionConverter}}" Width="*" MinWidth="75" SortMemberPath="ResizeResolutionArea"/>
                    <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="*" MinWidth="60"/>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>
    </DockPanel>
</Window>
