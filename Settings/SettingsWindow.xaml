<Window x:Class="AssetProcessor.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:behaviors="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:local="clr-namespace:AssetProcessor" 
        Title="Settings" Height="400" Width="600" ResizeMode="NoResize">
    <Grid>
        <TabControl x:Name="tabControl" Background="#FFF7F7F7">
            <TabItem Header="General">
                <GroupBox x:Name="projectsFolderGroup" Header="Projects Folder" Margin="2,0,2,0" VerticalAlignment="Top">
                    <Grid Margin="2">
                        <TextBox x:Name="ProjectsFolderBox" Text="{Binding ProjectsFolder, UpdateSourceTrigger=PropertyChanged}" VerticalContentAlignment="Center" IsReadOnly="True" MinWidth="200" Margin="2"/>
                        <Button Content="Select folder" Click="SelectFolder" AutomationProperties.Name="SelectFolder" HorizontalAlignment="Right" VerticalAlignment="Center" Width="86" Margin="2"/>
                    </Grid>
                </GroupBox>
            </TabItem>

            <TabItem Header="Playcanvas" Background="#FFFF6600">
                <StackPanel>
                    <TextBlock Margin="1,0,1,0" TextAlignment="Center" HorizontalAlignment="Center">
                            <Hyperlink NavigateUri="https://developer.playcanvas.com/user-manual/api/" RequestNavigate="Hyperlink_RequestNavigate">
                                Help
                            </Hyperlink>
                    </TextBlock>

                    <GroupBox Header="Playcanvas:" Background="#7FFF8A3C" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" BorderBrush="#FFFF8A3C">
                        <StackPanel>
                            <Label Content="Playcanvas API Key:" />
                            <TextBox x:Name="PlaycanvasApiKeyTextBox" Background="#FFD6A27B" ToolTip="Playcanvas API Key: o12PWdvxh56CMtw8jlvlF8jUytt1RjGd">
                                <behaviors:Interaction.Behaviors>
                                    <local:TextBoxWatermarkBehavior Watermark="Playcanvas API Key: o12PWdvxh56CMtw8jlvlF8jUytt1RjGd"/>
                                </behaviors:Interaction.Behaviors>
                            </TextBox>

                            <Label Content="User Name:" />
                            <TextBox x:Name="UsernameTextBox" Background="#FFD6A27B" ToolTip="Usr name in Playcanvas">
                                <behaviors:Interaction.Behaviors>
                                    <local:TextBoxWatermarkBehavior Watermark="Your username on playcanvas"/>
                                </behaviors:Interaction.Behaviors>
                            </TextBox>
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="Semaphore Limits" Margin="2,4,2,4">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center">
                                <TextBlock Text="Get Textures Semaphore Limit:" Margin="10,10,4,4" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                                <TextBlock x:Name="GetTexturesSemaphoreTextBlock" Width="50" VerticalAlignment="Center" Margin="0,10,4,4"/>
                            </StackPanel>
                            <Slider x:Name="GetTexturesSemaphoreSlider" Minimum="1" Maximum="256" ValueChanged="SemaphoreLimitSlider_ValueChanged" Width="550" Margin="2,2,2,2"/>

                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center">
                                <TextBlock Text="Download Semaphore Limit:" Margin="10,10,4,4" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                                <TextBlock x:Name="DownloadSemaphoreTextBlock" Width="50" VerticalAlignment="Center" Margin="0,10,4,4" HorizontalAlignment="Left"/>
                            </StackPanel>
                            <Slider x:Name="DownloadSemaphoreSlider" Minimum="1" Maximum="64" ValueChanged="SemaphoreLimitSlider_ValueChanged" Width="550" Margin="2,2,2,2"/>
                        </StackPanel>
                    </GroupBox>
                </StackPanel>
            </TabItem>

            <TabItem Header="Texture Conversion">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <GroupBox Header="KTX-Software Tools" Margin="0,0,0,6">
                            <StackPanel Margin="2">
                                <TextBlock Text="Leave empty to use from PATH" Margin="0,0,0,4" FontSize="10" Foreground="Gray"/>

                                <!-- toktx -->
                                <TextBlock Text="toktx:" Margin="0,0,0,2" FontWeight="SemiBold" FontSize="10"/>
                                <Grid Margin="0,0,0,2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="70"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBox x:Name="ToktxExecutableBox"
                                             Grid.Column="0"
                                             Text="{Binding ToktxExecutablePath, UpdateSourceTrigger=PropertyChanged}"
                                             VerticalContentAlignment="Center"
                                             Height="22"
                                             Margin="0,0,4,0"
                                             FontSize="10"/>

                                    <Button Grid.Column="1"
                                            Content="Browse"
                                            Click="SelectToktxExecutable"
                                            Height="22"
                                            Margin="0,0,4,0"
                                            FontSize="10"/>

                                    <Button Grid.Column="2"
                                            Content="Test"
                                            Click="TestToktx_Click"
                                            Height="22"
                                            FontSize="10"/>
                                </Grid>
                                <TextBlock x:Name="ToktxStatusText" Margin="0,0,0,4" FontSize="9" Foreground="Gray"/>

                                <!-- ktx -->
                                <TextBlock Text="ktx:" Margin="0,0,0,2" FontWeight="SemiBold" FontSize="10"/>
                                <Grid Margin="0,0,0,2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="70"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBox x:Name="KtxExecutableBox"
                                             Grid.Column="0"
                                             Text="{Binding KtxExecutablePath, UpdateSourceTrigger=PropertyChanged}"
                                             VerticalContentAlignment="Center"
                                             Height="22"
                                             Margin="0,0,4,0"
                                             FontSize="10"/>

                                    <Button Grid.Column="1"
                                            Content="Browse"
                                            Click="SelectKtxExecutable"
                                            Height="22"
                                            Margin="0,0,4,0"
                                            FontSize="10"/>

                                    <Button Grid.Column="2"
                                            Content="Test"
                                            Click="TestKtx_Click"
                                            Height="22"
                                            FontSize="10"/>
                                </Grid>
                                <TextBlock x:Name="KtxStatusText" Margin="0,0,0,4" FontSize="9" Foreground="Gray"/>

                                <!-- Installation info -->
                                <TextBlock Text="Install:" Margin="0,2,0,0" FontWeight="SemiBold" FontSize="10"/>
                                <TextBlock TextWrapping="Wrap" Margin="0,0,0,0" FontSize="9">
                                    <Run Text="winget install KhronosGroup.KTX-Software" FontFamily="Consolas"/>
                                </TextBlock>
                            </StackPanel>
                        </GroupBox>

                        <GroupBox Header="Performance (Global)" Margin="0,0,0,6">
                            <StackPanel Margin="2">
                                <TextBlock Text="Apply to all conversions" Margin="0,0,0,4" FontSize="10" Foreground="Gray"/>

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="SSE4.1:" VerticalAlignment="Center" Margin="0,2" FontSize="10"/>
                                    <CheckBox Grid.Row="0" Grid.Column="1" x:Name="UseSSE41CheckBox" IsChecked="{Binding UseSSE41}" VerticalAlignment="Center" Margin="0,2"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="OpenCL:" VerticalAlignment="Center" Margin="0,2" FontSize="10"/>
                                    <CheckBox Grid.Row="1" Grid.Column="1" x:Name="UseOpenCLCheckBox" IsChecked="{Binding UseOpenCL}" VerticalAlignment="Center" Margin="0,2"/>

                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Multithreading:" VerticalAlignment="Center" Margin="0,2" FontSize="10"/>
                                    <CheckBox Grid.Row="2" Grid.Column="1" x:Name="UseMultithreadingCheckBox" IsChecked="{Binding UseMultithreading}" VerticalAlignment="Center" Margin="0,2"/>

                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Threads:" VerticalAlignment="Center" Margin="0,2" FontSize="10"/>
                                    <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal" Margin="0,2">
                                        <Slider x:Name="ThreadCountSlider"
                                                Value="{Binding ThreadCount}"
                                                Minimum="0"
                                                Maximum="32"
                                                Width="160"
                                                TickFrequency="1"
                                                IsSnapToTickEnabled="True"
                                                VerticalAlignment="Center"/>
                                        <TextBlock Text="{Binding ElementName=ThreadCountSlider, Path=Value}"
                                                   Margin="6,0,0,0"
                                                   VerticalAlignment="Center"
                                                   Width="20"
                                                   FontSize="10"/>
                                        <TextBlock Text="(0=auto)"
                                                   Margin="3,0,0,0"
                                                   VerticalAlignment="Center"
                                                   FontSize="9"
                                                   Foreground="Gray"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </GroupBox>

                        <GroupBox Header="D3D11 Texture Viewer (Test)" Margin="0,0,0,6">
                            <StackPanel Margin="2">
                                <TextBlock Text="Test the new GPU-based texture viewer" Margin="0,0,0,4" FontSize="10" Foreground="Gray"/>
                                <Button Content="Open D3D11 Viewer Test Window"
                                        Click="TestD3D11Viewer_Click"
                                        Height="24"
                                        Margin="0,2,0,0"
                                        FontSize="10"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <TabItem Header="TinyPng">
            </TabItem>
        </TabControl>
        <DockPanel>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Height="32" VerticalAlignment="Bottom" Margin="4,4,4,4">
                <Button Content="Save" Click="Save_Click" Margin="5" />
                <Button Content="Cancel" Click="Cancel_Click" Margin="5" />
            </StackPanel>
        </DockPanel>
    </Grid>
</Window>
